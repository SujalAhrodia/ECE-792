---
 - hosts: localhost
   become: true
   tasks:
       # Create OVS Bridge
    - name: Add dependencies
      pip:
        name: lxml

    - name: Create OVS bridge
      openvswitch_bridge:
        bridge: ssw3
        state: present
      tags:
        - create_ovs
     
    - name: Change OVS bridge to routed mode
      command: sudo ip addr add 20.0.0.1/24 dev ssw3
      tags:
        - route
    
    - name: Define network 
      virt_net:
        command: define
        name: snet3
        xml: "{{ lookup('template','./snet3.xml.j2') }}"
      tags:
        - define_ovs
    
    - name: Start network
      virt_net:
        command: start
        name: snet3
      tags:
        - start_ovs_net
    
